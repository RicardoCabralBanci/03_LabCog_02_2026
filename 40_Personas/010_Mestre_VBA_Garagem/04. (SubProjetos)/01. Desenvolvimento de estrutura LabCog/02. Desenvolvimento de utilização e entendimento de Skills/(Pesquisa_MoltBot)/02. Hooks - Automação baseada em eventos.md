# Hooks - Automa√ß√£o baseada em eventos

> Fonte: `docs/hooks.md` do reposit√≥rio MoltBot

## O que s√£o Hooks?

Hooks s√£o **scripts pequenos que executam quando algo acontece**. √â um sistema event-driven para automatizar a√ß√µes em resposta a comandos e eventos do agente.

## Dois tipos

- **Hooks**: Rodam dentro do Gateway quando eventos do agente disparam (`/new`, `/reset`, `/stop`)
- **Webhooks**: HTTP externos que permitem outros sistemas acionar trabalho no MoltBot

## Estrutura de um Hook

```
my-hook/
‚îú‚îÄ‚îÄ HOOK.md       ‚Üí Metadata (YAML frontmatter) + documenta√ß√£o
‚îî‚îÄ‚îÄ handler.ts    ‚Üí Implementa√ß√£o do handler
```

### HOOK.md ‚Äî Metadata
```yaml
---
name: my-hook
description: "O que este hook faz"
metadata: {"moltbot":{"emoji":"üéØ","events":["command:new"]}}
---
```

### handler.ts ‚Äî L√≥gica
```typescript
const handler: HookHandler = async (event) => {
  if (event.type !== 'command' || event.action !== 'new') return;
  // L√≥gica aqui
  event.messages.push('Hook executado!');
};
export default handler;
```

## Tipos de eventos

| Tipo | Eventos | Quando dispara |
|------|---------|----------------|
| **Command** | `command:new`, `command:reset`, `command:stop` | Usu√°rio envia comando |
| **Agent** | `agent:bootstrap` | Antes de injetar arquivos no contexto |
| **Gateway** | `gateway:startup` | Quando o gateway inicia |

## Descoberta autom√°tica (3 locais, por preced√™ncia)

1. **Workspace** `<workspace>/hooks/` ‚Äî por agente, maior preced√™ncia
2. **Managed** `~/.clawdbot/hooks/` ‚Äî compartilhado entre workspaces
3. **Bundled** ‚Äî enviado com o MoltBot

## Hooks embutidos

| Hook | Evento | O que faz |
|------|--------|-----------|
| **session-memory** | `command:new` | Salva contexto da sess√£o em `memory/` |
| **command-logger** | `command` | Loga comandos em `commands.log` (JSONL) |
| **boot-md** | `gateway:startup` | Roda `BOOT.md` quando gateway inicia |
| **soul-evil** | `agent:bootstrap` | Troca `SOUL.md` por `SOUL_EVIL.md` (por chance ou janela) |

## CLI

```bash
moltbot hooks list          # Listar hooks
moltbot hooks enable <id>   # Ativar
moltbot hooks disable <id>  # Desativar
moltbot hooks info <id>     # Detalhes
moltbot hooks check         # Elegibilidade
```

## Relev√¢ncia para o LabCog

O conceito de hooks √© poderoso para automa√ß√£o. Podemos pensar em hooks que:
- Salvam estado/progresso ao mudar de sess√£o
- Logam a√ß√µes para auditoria
- Disparam automa√ß√µes quando eventos espec√≠ficos acontecem
- Preparam o contexto antes de uma sess√£o come√ßar
