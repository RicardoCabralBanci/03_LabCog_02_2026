# Planejamento Tático: Integração de Assets Reais (V3.5)

**Alvo**: `mod_UI_ZoneA` (Galeria) e `mod_UI_ZoneB` (Detalhes)
**Objetivo**: Substituir placeholders e caminhos hardcoded por uma leitura dinâmica baseada na estrutura de pastas `assets`.

---

## 1. O Problema Atual (Cegueira Digital)

Atualmente, o código VBA sofre de dois problemas:
1.  **Amnésia de Caminho**: Ele ignora o caminho da imagem definido no Banco de Dados (`Catalog.ImgPath`) e tenta carregar sempre `\Imagens\IHM_Generica.png`.
2.  **Estética Vetorial**: Na Zona B, o ícone do Word é um desenho vetorial (Shape) nativo do Excel, que destoa do visual "Modern/Fluent" que desejamos.

---

## 2. A Solução para a Zona A (`mod_UI_ZoneA`)

**Meta**: Carregar a foto real de cada IHM no Card da Galeria.

### Alterações no Procedimento `Draw_Card_Matrix`:
1.  **Construção do Caminho Absoluto**:
    *   Fórmula: `PathFinal = ThisWorkbook.Path & "\" & data.ImgPath`
    *   Isso permite que o projeto funcione em qualquer computador, desde que a pasta `assets` viaje junto.
2.  **Validação de Existência (`Dir`)**:
    *   Antes de chamar `AddPicture`, o código verificará `If Dir(PathFinal) <> ""`.
    *   Isso impede o **Erro 1004** (Arquivo não encontrado) que trava a macro e assusta o usuário.
3.  **Fallback (Plano B)**:
    *   Se a imagem não existir, desenharemos um **Retângulo Cinza Neutro** (`RGB 220,220,220`).
    *   Isso serve como um "aviso visual" de que falta a imagem, sem quebrar a funcionalidade.

---

## 3. A Solução para a Zona B (`mod_UI_ZoneB`)

**Meta**: Refinar o painel de detalhes e a lista de documentos.

### A. Painel de Hardware (`Render_Hardware_Panel`):
*   **Lógica**: Mesma da Zona A.
*   Deve carregar a imagem em alta resolução (que geralmente é a mesma do thumbnail, mas ampliada) usando o caminho do DB.

### B. Lista de Documentos (`Draw_Doc_Item`):
*   **Target**: Substituir o `msoShapeFlowchartDocument` por `assets\System\icon_word.png`.
*   **Implementação**:
    ```vba
    caminhoIcone = ThisWorkbook.Path & "\assets\System\icon_word.png"
    Se Dir(caminhoIcone) Existe:
        AddPicture(caminhoIcone, Transparente)
    Senão:
        Desenhar_Shape_Antigo() ' Fallback de segurança
    Fim Se
    ```
*   **Robustez**: O sistema nunca deve depender de um arquivo externo cosmético para funcionar. Se alguém deletar o ícone, o código se adapta.

---

## 4. Estrutura de Dados Esperada (Exemplo)

Para que isso funcione, a tabela Excel (`DB_Models`) deve estar preenchida assim:

| ID | Modelo | ImgPath (Coluna H) | Resultado Esperado |
| :--- | :--- | :--- | :--- |
| 1 | Clearline 3.0 | `assets\thumbs\cl30.png` | ✅ Carrega a foto |
| 2 | Siemens TP | `assets\thumbs\sie_tp.png` | ✅ Carrega a foto |
| 3 | Teste Quebrado | `caminho\errado.png` | ⬜ Retângulo Cinza (Fallback) |

---

## 5. Próximo Passo (Execução)

Autorizar a aplicação destas lógicas nos arquivos:
*   `70.2 mod_UI_ZoneA_v4.md`
*   `70.3 mod_UI_ZoneB_v1.md`
