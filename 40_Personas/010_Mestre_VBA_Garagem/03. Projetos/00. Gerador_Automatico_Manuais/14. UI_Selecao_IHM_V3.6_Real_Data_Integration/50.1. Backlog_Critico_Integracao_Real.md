# Relat√≥rio de Patologia e Plano de Reanima√ß√£o (v50.1)

**Diagn√≥stico**: O sistema exibe "Nenhum m√≥dulo mapeado" quando a busca no DB falha, quebrando a experi√™ncia visual. O usu√°rio exige que a estrutura (lista de cap√≠tulos) **sempre apare√ßa**, mantendo a consist√™ncia visual da "Imagem 00024", mesmo que para mostrar que tudo est√° bloqueado/inexistente.

**Objetivo Cr√≠tico**: Implementar a "Garantia de Estrutura Visual". Nunca exibir lista vazia.

---

## 1. Disfun√ß√µes Atuais

1.  **Tela Vazia em Falha de DB**: Se `Fetch_Docs_From_DB` retorna 0 (erro de ID ou falta de dados), a UI morre.
2.  **Compara√ß√£o Fr√°gil**: A busca no DB pode estar falhando por comparar Texto vs N√∫mero (`Val`).

---

## 2. O Plano de A√ß√£o (Refinamento Zona B)

### Passo A: Conex√£o Neural (Robustez)
1.  **Blindagem de Tipo**: Usar `Val(data)` = `Val(id)` na busca.
2.  **Fallback de Esqueleto**: Se a busca retornar 0 itens, acionar o `Generate_Skeleton_Structure`.
    *   Este esqueleto cria os 4 itens padr√£o (Interface, Modos, Opera√ß√£o, Falhas).
    *   Ele tenta adivinhar o caminho padr√£o.
    *   Se n√£o achar o arquivo, renderiza como **Bloqueado** (√çcone Cinza + Tooltip), mas **RENDERIZA**.

### Passo B: Reconstru√ß√£o Facial (Visual)
*   Mant√©m a l√≥gica da v1.2:
    *   **Arquivo Existe** -> √çcone Word Clic√°vel.
    *   **Arquivo N√£o Existe** -> √çcone Bloqueado (üö´) com Tooltip "Para essa IHM n√£o existe...".
*   **Resultado Final**: O usu√°rio sempre v√™ a lista preenchida. Na pior das hip√≥teses, v√™ 4 linhas com √≠cones de bloqueio, mas sabe que a estrutura existe.

### Passo C: O Reflexo Motor
*   Mant√©m o `Doc_Open_Handler` v1.2.

---

## 3. Especifica√ß√£o T√©cnica Atualizada

### L√≥gica do Fallback (Esqueleto)
```vba
If docCount = 0 Then
    ' N√£o deixe a tela vazia! Crie a estrutura padr√£o.
    docCount = 4
    ReDim docs(1 To 4)
    docs(1).Capitulo = "01. Interface": docs(1).Existe = Check(...)
    docs(2).Capitulo = "02. Modos":     docs(2).Existe = Check(...)
    ' ...
End If
' Renderize o que tiver (seja real ou esqueleto)
```

---

**Pr√≥ximo Passo**: Atualizar `70.3.1` com o Fallback de Esqueleto e a corre√ß√£o do `Val()`.