# Especifica√ß√£o de UI v3.2: O Cockpit de Engenharia (Atualizado)

**Status**: Misto (Zona A = Constru√≠do | Zonas B/C = A Construir)
**Conceito**: Interface Data-Driven com Grid R√≠gido e Est√©tica Industrial.

---

## 1. Grid System (Layout Geral - Consolidado V3.6)

A tela adota um layout de "Tr√™s Pain√©is" com unifica√ß√£o visual no cabe√ßalho.

| Colunas | Zona | Fun√ß√£o | Comportamento Atual (V3.6) |
| :--- | :--- | :--- | :--- |
| **A** | **Zona A.1 (Sidebar)** | Filtros | Fundo S√≥lido `RGB(45,45,45)`. Largura 25. |
| **B** | **Ponte/Gutter** | Margem | Parte do Header na Linha 4. Vazio nas demais. Largura 2. |
| **C:E** | **Zona A.2 (Galeria)** | Matriz de Cards | Grid 3x3. Fundo Branco/Neutro. Largura 22 cada. |
| **F** | *Espa√ßador* | Separador | Vazio (Largura 2px). |
| **G:H** | **Zona B (Visual)** | Detalhes Visuais | Thumbnail Grande + Descri√ß√£o. |
| **I** | *Espa√ßador* | Separador | Vazio (Largura 2px). Divide a Zona B em duas. |
| **J:L** | **Zona B (Lista)** | Tabela de Manuais | Lista de Cap√≠tulos e Status. |
| **M** | *Espa√ßador* | Separador | Vazio (Largura 2px). |
| **N:Q** | **Zona C (Input)** | √Årea de Screenshot | *A Implementar (Spec Abaixo)* |

---

## 2. Detalhamento da Zona A (Implementado - As Built)

### A. Cabe√ßalho Unificado (A Ponte)
*   **Linha 4**: Atua como uma barra de ferramentas cont√≠nua.
*   **A4**: "FILTROS" (Fundo Cinza Grafite `RGB(60,60,60)`).
*   **B4:E4**: "CAT√ÅLOGO DE MODELOS" (Shape Retangular √∫nico cruzando as colunas). Elimina o "buraco branco" visual da coluna B.

### B. Sidebar de Filtros (Coluna A)
*   **Estilo**: Bot√µes "Flat" sem efeitos 3D/Bevel.
*   **Cores**:
    *   **Ativo**: Cinza M√©dio `RGB(80,80,80)` + Sombra Sutil.
    *   **Inativo**: Cinza Claro `RGB(210,210,210)` (Texto Escuro).
*   **L√≥gica**: Filtros aditivos (Clearline, Siemens, Rockwell). O clique for√ßa o re-render total da galeria.

### C. A Galeria (Colunas C:D:E)
*   **Matriz**: Distribui√ß√£o matem√°tica `(Index Mod 3)` preenchendo colunas C -> D -> E antes de pular linha.
*   **Card Design**:
    *   **Fundo**: Ret√¢ngulo Arredondado `RGB(245,245,245)`.
    *   **Imagem**: Carregamento din√¢mico via `Planilha66` ("ihm_models"). Fallback para `\Imagens\IHM_Generica.png` se falhar.
    *   **Badge**: Tag colorida baseada no Fabricante (KHS=Cinza/Azul, Siemens=Teal, Rockwell=Laranja) exibindo o `Engine` (WinCC, Zenon).
*   **Clean Up**: Uso de `ShapeRange.Group` para garantir que cards deletados n√£o deixem "fantasmas".

---

## 3. Detalhamento da Zona B (O Compositor de Manuais) - üöß A CONSTRUIR

Esta zona (Colunas **F:L**) atua como painel de confirma√ß√£o. Deve ser disparada pelo evento `Card_Click_Handler`.

### B.1 Sub-Painel Visual (Colunas F:H)
*   **Thumbnail Ampliada**: Ao clicar no card, carregar a imagem em alta resolu√ß√£o aqui (Range `F5:H15` - Ajustar conforme merge).
*   **Descri√ß√£o**: Texto do campo `Descricao_Visual` abaixo da imagem.

### B.2 Lista de Refer√™ncias (Colunas J:L)
Lista imut√°vel dos documentos que comp√µem o manual, separada da parte visual pela Coluna I.
*   **Fonte**: Tabela `DB_Mapping` filtrada pelo ID da IHM.
*   **Renderiza√ß√£o**:
    *   **Col J**: Nome do M√≥dulo (ex: "01. Interface").
    *   **Col K**: Mensagem de Status (ex: "M√≥dulo n√£o aplic√°vel...").
    *   **Col L**: A√ß√£o (√çcone Word/Abrir).

---

## 4. Detalhamento da Zona C (Landing Zone) - üöß A CONSTRUIR

Localizada nas colunas **M:P**. Foco na intera√ß√£o do usu√°rio (Colar Print).

### C.1 A Landing Zone (Container)
*   **Alvo**: Range `M5:P19`.
*   **Visual**: Borda tracejada (Dash) indicando "Drop Zone".
*   **Macro `UI_Paste_Smart`**:
    1.  Captura Bitmap do Clipboard.
    2.  Cola e redimensiona (`LockAspectRatio`) para caber em `M5:P19`.
    3.  Renomeia shape para `IMG_USER_COVER`.

### C.2 Bot√£o "Ignite" (Gerar)
*   **Local**: Linha 24 (Largura M:P).
*   **Fun√ß√£o**: Dispara o processo de montagem do manual final usando a lista da Zona B e a imagem da Zona C.