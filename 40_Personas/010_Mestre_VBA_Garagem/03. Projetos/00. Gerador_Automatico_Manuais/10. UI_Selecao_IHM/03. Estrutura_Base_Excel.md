# Estrutura de Dados: Excel como Database

**Status**: Definido  
**Autor**: Mestre em VBA  
**Objetivo**: Organizar a persistência de dados dentro do próprio arquivo `.xlsm` de forma estruturada e segura.

---

## 1. A Estratégia "VeryHidden"
Para evitar que o usuário final apague a base de dados por acidente (ou por curiosidade), usaremos o estado `xlSheetVeryHidden`.
*   **Diferença**: Uma aba `Hidden` pode ser reexibida pelo menu do Excel. Uma `VeryHidden` só pode ser reexibida via VBA ou via propriedades no Editor (F4).
*   **Nome da Aba**: `DB_Assets` ou `sys_data`.

## 2. Organização via Tabelas (ListObjects)
Nunca leremos células soltas como `Range("A2")`. Usaremos **Tabelas Nomeadas**.
*   **Vantagem**: O C# e o VBA podem referenciar a tabela pelo nome (`Range("TabelaIHMs")`). Se o usuário inserir uma coluna no meio, o código não quebra.

### Tabela Sugerida: `tbl_IHM_Models`
| ID (Key) | Nome_Exibicao | Descricao | Imagem_Path | Config_ID |
| :--- | :--- | :--- | :--- | :--- |
| IHM_V2_INP | Innopack V2 | Padrão 2024+ | resources/ihm_v2.png | CFG_001 |
| IHM_V1_LEG | Legacy IHM | Máquinas Antigas | resources/ihm_v1.png | CFG_999 |

---

## 3. Acesso aos Dados

### Via VBA (O jeito "Interno")
```vba
Function GetIHMData() As ListObject
    Set GetIHMData = ThisWorkbook.Sheets("sys_data").ListObjects("tbl_IHM_Models")
End Function
```

### Via C# (O jeito "Externo")
O C# usará o Interop para ler o `ListObject`. Ele percorre as linhas da tabela e as converte em Objetos C# (POCOs) para popular os **Cards da UI**.

---

## 4. Segurança e Integridade
*   **Proteção de Planilha**: A aba de dados deve estar protegida com senha para evitar edições manuais enquanto o sistema estiver rodando.
*   **Validação**: O sistema deve verificar na inicialização se as tabelas essenciais existem. Se alguém deletar a aba, o sistema deve recriá-la (Auto-Healing).

---

## 5. Próximos Passos
1. Criar o protótipo da aba `sys_data` no Excel.
2. Preencher com os dados reais das IHMs disponíveis.
3. Desenvolver o **Data Provider** em C# que lê essa tabela.
