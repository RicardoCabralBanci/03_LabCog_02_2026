# Plano Cirúrgico: Reconstrução do Corpo do Manual (Template Engine)

**Status da Missão**: A Capa está estável. O foco agora é a consistência estrutural do corpo do documento (Módulos, Segurança, Operação).
**Objetivo**: Alcançar paridade visual e estrutural 1:1 entre um Manual de Referência (Legado/Innopal) e o Manual Gerado pela NewEngine.

## 1. A Mesa de Autópsias (Metodologia)
A estratégia "Bater Arquivos" será executada em ciclos iterativos:
1.  **Extração**: Desmembrar o `.docx` de referência (unzip) para expor o `word/document.xml` e `word/numbering.xml`.
2.  **Geração**: Rodar a `NewEngine` atual para gerar o esboço.
3.  **Diferencial (Diff)**: Comparar não o visual, mas a hierarquia XML.
    *   *Por que o espaçamento quebrou?* (Verificar `<w:pPr>` e estilos).
    *   *Por que a lista numerada reiniciou?* (Verificar `<w:numId>` e `abstractNum`).

## 2. O Paciente Zero (Definição do Padrão)
Precisamos definir qual arquivo é a "Verdade Absoluta".
*   [ ] **Ação**: Identificar um manual PDF/Word que servirá de gabarito.
*   [ ] **Ação**: Isolar um capítulo complexo (ex: Capítulo 5 - Manutenção) para ser o teste de estresse.

## 3. Fases da Reconstrução

### Fase A: Estrutura Óssea (Seções e Quebras)
*   Verificar se as quebras de seção (`<w:sectPr>`) estão preservando cabeçalhos e rodapés corretos entre capa, índice e conteúdo.
*   Validar margens e orientação de página.

### Fase B: Sistema Nervoso (Estilos e Fontes)
*   Mapear estilos do Word Legado (`Normal`, `Título 1`, `Heading 2`, `Corpo de Texto`).
*   Garantir que a `NewEngine` (C#) não está injetando estilos "Hardcoded" (direto no parágrafo) em vez de referenciar o `styles.xml`. *Isso é crime capital.*

### Fase C: Numeração Dinâmica (O Pesadelo)
*   O maior vilão do Word. Listas `1.`, `1.1`, `1.1.1`.
*   Verificar se o `abstractNumId` está sendo reutilizado corretamente ou se estamos criando uma nova lista a cada parágrafo (o que quebra a indentação).

## 4. Ferramentas Necessárias
*   **DocxReconstructor**: (Ferramenta que mencionei na minha memória, se ela existir mesmo).
*   **Beyond Compare / WinMerge**: Para diff de texto/XML.
*   **OpenXML Productivity Tool**: Para ver o código C# equivalente ao XML do Word.

## 5. Próximos Passos Imediatos
1.  Selecionar o arquivo "Gabarito".
2.  Gerar uma versão atual com a engine.
3.  Listar as 3 principais discrepâncias visuais óbvias.
