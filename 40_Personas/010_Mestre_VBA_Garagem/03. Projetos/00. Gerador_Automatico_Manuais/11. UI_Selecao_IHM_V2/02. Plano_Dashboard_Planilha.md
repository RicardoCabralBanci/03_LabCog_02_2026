# Plano de Arquitetura: Dashboard de Seleção na Planilha (Shapes)

**Status**: Definido  
**Objetivo**: Criar uma interface de seleção de IHM usando objetos gráficos (Shapes) desenhados diretamente na planilha do Excel, sem janelas flutuantes (UserForms).

---

## 1. O Conceito Visual: "Shapes como Botões"

O usuário verá uma aba limpa (sem linhas de grade), com um título "Selecione o Modelo de IHM" e uma grade de cartões visuais.

### Anatomia do Card (Grupo de Shapes)
Cada "Botão" não será um controle ActiveX (que são instáveis), mas sim um **Grupo de Formas** nativas do Excel:
1.  **Fundo**: Retângulo com Cantos Arredondados (`msoShapeRoundedRectangle`).
    *   *Nome*: `bg_IHM_001` (Prefixo 'bg_' + ID).
2.  **Imagem**: Picture inserida centralizada no topo.
    *   *Nome*: `img_IHM_001`.
3.  **Texto**: Label ou TextBox com o nome da IHM.
    *   *Nome*: `lbl_IHM_001`.
4.  **Overlay de Clique**: Um retângulo transparente invisível por cima de tudo para capturar o clique com facilidade.
    *   *Nome*: `btn_IHM_001`.
    *   *Ação*: Executar macro `Card_Click`.

---

## 2. A Engenharia (VBA Builder)

Não desenharemos nada na mão. O VBA será o "Renderizador".

### Módulo `mod_Dashboard_Render`
*   **Sub `Render_IHM_Gallery()`**:
    1.  Limpa todos os shapes antigos da área de seleção.
    2.  Lê a tabela de dados (`sys_data`).
    3.  Para cada IHM:
        *   Calcula posição `Top` e `Left` baseada em Colunas/Linhas (Grid Layout).
        *   Cria o Shape de Fundo.
        *   Insere a Imagem (LoadPicture).
        *   Adiciona o Texto.
        *   Agrupa tudo (opcional, mas melhor para mover).
        *   Atribui a macro `.OnAction = "Card_Click"`.

### Módulo `mod_Dashboard_Interaction`
*   **Sub `Card_Click()`**:
    1.  Identifica qual botão chamou (`Application.Caller`).
    2.  Extrai o ID do nome do shape (ex: de `btn_IHM_001` tira `001`).
    3.  **Feedback Visual**:
        *   Percorre todos os shapes de fundo (`bg_*`).
        *   Pinta todos de Cinza/Branco.
        *   Pinta o fundo do ID selecionado de **Laranja/Azul** (Destaque).
        *   Adiciona efeito de "Sombra" ou "Brilho" no selecionado.
    4.  **Persistência**: Escreve o ID selecionado numa célula nomeada `selected_ihm_id`.

---

## 3. Fluxo de Uso
1.  Usuário abre a ferramenta.
2.  Auto_Open (ou botão "Reset") roda `Render_IHM_Gallery` para garantir que os botões estão atualizados com o banco de dados.
3.  Usuário vê as opções na planilha.
4.  Clica na imagem da "Innopack V2".
5.  O cartão brilha/muda de cor.
6.  Célula `selected_ihm_id` recebe o valor.
7.  Botão "Gerar Manual" (separado) lê essa célula e inicia o processo.

---

## 4. Vantagens desta abordagem
*   **Nativo**: Parece que faz parte do Excel.
*   **Zoom**: Se o usuário der zoom na planilha, os botões aumentam junto.
*   **Impressão**: Se imprimir a aba, o menu sai no papel (pode ser útil para documentação).
*   **Zero Instalação**: Funciona em qualquer Excel com macros ativas.

## 5. Próximos Passos
1.  Criar o módulo de renderização (`mod_Render.bas`).
2.  Criar o módulo de interação (`mod_Interaction.bas`).
3.  Definir imagens de placeholder para teste.
