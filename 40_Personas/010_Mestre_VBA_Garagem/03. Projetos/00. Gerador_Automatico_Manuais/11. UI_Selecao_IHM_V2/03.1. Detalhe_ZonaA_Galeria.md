# Especificação Técnica Detalhada: Zona A (A Galeria de IHMs)

**Referência**: Detalhamento da "Zona A.2" do plano mestre.
**Objetivo**: Definir a anatomia visual, regras de renderização e comportamento dos "Rich Cards" com Badges.

---

## 1. Anatomia do "Rich Card" (Visual Blueprint)

Cada card não é um shape único, mas um **Grupo de Shapes** (Group) manipulado como objeto único.

**Dimensões Base:**
*   **Largura Total**: ~280px (Ocupa colunas B:C ou B:D dependendo da largura da coluna)
*   **Altura Total**: 70px

**Componentes Internos (Layers):**

| Camada (Z-Order) | Nome do Elemento | Tipo Shape   | Posição (Relativa)     | Estilo Visual                                      |
| :--------------- | :--------------- | :----------- | :--------------------- | :------------------------------------------------- |
| **0 (Fundo)**    | `bg_Base`        | Rounded Rect | 0, 0                   | Branco, Sombra suave (Blur 4px), Borda Cinza Claro |
| **1 (Img)**      | `img_Thumb`      | Rect         | Left: 5px, Top: 5px    | Dim: 60x60px. Placeholder Cinza ou Imagem real.    |
| **2 (Texto)**    | `txt_Title`      | Textbox      | Left: 75px, Top: 8px   | Fonte Segoe UI 11pt Bold, Cor Cinza Escuro.        |
| **3 (Badge)** | `bdg_Engine` | Rounded Rect | Left: 75px, Top: 40px | Dim: 50x18px. Cor baseada na Engine (ver regras). |
| **3 (Badge)** | `bdg_Size` | Rounded Rect | Left: 130px, Top: 40px | Dim: 40x18px. Cor Cinza Médio. |

---


## 2. Sistema de Cores e Badges (Lógica Visual)

O VBA deve ler os dados da `tbl_IHM_Catalog` e aplicar cores dinâmicas.

### A. Badge de Tecnologia e Marca (`Brand/Engine`)
*Regra*: O VBA busca o valor na coluna **Fabricante** da tabela de modelos (`ihm_models`).

*   **SIEMENS**: Azul (`RGB(0, 101, 189)`)
*   **CLEARLINE**: Cinza Azulado (`RGB(110, 130, 150)`) - *Identidade KHS/Zenon.*
*   **ROCKWELL**: Laranja (`RGB(230, 70, 0)`)
*   **OUTROS**: Cinza Médio (`RGB(150, 150, 150)`)

---

## 3. Comportamento de Interação (UX)

### Estado Normal (Idle)
*   Borda: Cinza Claro (1px).
*   Sombra: Leve.

### Estado Hover (Opcional/Avançado)
*   *Nota*: O VBA não tem evento "Hover" nativo fácil para Shapes. Vamos focar no clique.

### Estado Selecionado (Active)
Quando o usuário clica em qualquer parte do grupo:
1.  **Feedback Visual**:
    *   Borda muda para **Laranja KHS (`RGB(255, 102, 0)`)**.
    *   Espessura da borda aumenta para 2px ou 3px.
    *   Todos os outros cards voltam ao "Estado Normal".
2.  **Gatilho de Dados**:
    *   O código extrai o ID do card (ex: armazenado no `AlternativeText` ou no nome do shape `grp_card_khs_v3`).
    *   Chama `Load_ZoneB(ID_Selecionado)`.

---

## 4. Estratégia de Renderização VBA

Para manter o código limpo, usaremos uma "Função Construtora".

```vba
' Pseudo-código da função principal
Function Draw_Rich_Card(data As T_IHM_Card, topPos As Double) As Double
    ' 1. Cria o Grupo container (ou desenha shapes soltos agrupados logicamente)
    
    ' 2. Desenha Fundo
    Set bg = Shapes.AddShape(...)
    bg.OnAction = "Card_Click_Handler" ' O clique no fundo captura a ação
    
    ' 3. Desenha Badges
    Draw_Badge data.Engine, ...
    Draw_Badge data.Size, ...
    
    ' 4. Retorna a nova posição Top para o próximo card
    Draw_Rich_Card = topPos + 75 ' Altura + Margem
End Function
```
