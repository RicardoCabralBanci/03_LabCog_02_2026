# Plano de Arquitetura: UI de Seleção de IHM (VBA Puro)

**Status**: Em Planejamento  
**Objetivo**: Criar uma interface moderna, intuitiva e robusta para seleção de modelos de IHM dentro do Excel, sem dependências externas (DLLs/Add-ins).

---

## 1. O Conceito Visual: "Card Selection"

Queremos fugir do visual "anos 90" (Listbox cinza). O objetivo é uma grade de opções onde cada item é um **Cartão (Card)**.

### Anatomia de um Card
Cada cartão será composto visualmente por:
1.  **Container**: Um `Frame` (Moldura) que agrupa os elementos.
2.  **Thumbnail**: Um controle `Image` no topo/esquerda exibindo a foto da IHM.
3.  **Título**: Um `Label` com fonte em Negrito (ex: "Innopack V2").
4.  **Descrição**: Um `Label` menor com texto cinza (ex: "Padrão para máquinas 2024+").
5.  **Indicador de Seleção**: Uma borda colorida ou mudança de cor de fundo quando selecionado.

---

## 2. As Opções Técnicas (Como fazer isso no VBA?)

### Opção A: UserForm Dinâmico com Classes (RECOMENDADA)
Usamos a capacidade do VBA de criar controles em tempo de execução (`Controls.Add`) e gerenciá-los via Classes.

*   **Prós**:
    *   100% Nativo (funciona em qualquer Excel).
    *   Performance boa.
    *   Código organizado (OOP).
*   **Contras**:
    *   O `Scroll` (Barra de Rolagem) precisa ser configurado manualmente no UserForm.
    *   Criar sombras e bordas arredondadas é difícil (visual "quadrado" do Windows clássico).

### Opção B: WebBrowser Control (HTML/CSS)
Inserimos um controle de navegador no UserForm e desenhamos a interface com HTML e CSS modernos.

*   **Prós**:
    *   Visual infinito (Bordas arredondadas, sombras, animações CSS).
    *   Parece um app web moderno.
*   **Contras**:
    *   **Alta Complexidade**: Requer gerar HTML string no VBA.
    *   **Compatibilidade**: Pode dar erro dependendo da versão do IE/Edge instalada na máquina do usuário.
    *   **Segurança**: Macros com WebBrowser as vezes são bloqueadas por TI.

### Opção C: Shapes na Planilha (Dashboard)
Não usamos UserForm. Desenhamos retângulos e imagens direto numa aba do Excel e usamos macros de clique.

*   **Prós**:
    *   Zero código de UI complexo.
*   **Contras**:
    *   Parece "planilha", não "software".
    *   O usuário pode arrastar os botões sem querer se não proteger bem.
    *   Scroll da planilha é estranho para menus.

---

## 3. Detalhamento da Opção A (A Escolha Profissional)

Vamos seguir com a **Opção A** por ser o equilíbrio perfeito entre estabilidade corporativa e usabilidade.

### Estrutura de Classes

#### 1. `IHMCard.cls` (O Cérebro do Card)
Esta classe "finge" que o Frame+Image+Label são um único objeto.
*   **Propriedades**: `.ID`, `.Title`, `.IsSelected`.
*   **Métodos**: `.Setup()`, `.SetSelection()`.
*   **Eventos**: Dispara `Clicked(ID)` quando o usuário clica em qualquer parte do card.

#### 2. `uf_Selector` (O UserForm)
O formulário vazio que serve de palco.
*   Contém apenas um **Frame Principal** (`fra_Container`) com barra de rolagem vertical ativada.
*   No evento `Initialize`, ele lê os dados e chama o `CardFactory`.

#### 3. `mod_CardFactory` (O Construtor)
Módulo padrão que lê a tabela de dados e gera os cartões.
*   Loop pelos dados -> `Controls.Add("Forms.Frame.1")` -> Instancia `New IHMCard` -> Adiciona numa `Collection`.

---

## 4. Fluxo de Uso
1.  Usuário clica em "Gerar Manual".
2.  VBA carrega a lista de IHMs da aba `sys_data` (ou CSV de teste).
3.  VBA calcula posições (X, Y) para organizar os cards em grade (ex: 2 colunas).
4.  UserForm abre exibindo as opções.
5.  Usuário clica num Card -> Borda fica azul.
6.  Usuário clica em "Confirmar".
7.  UserForm fecha e retorna o ID selecionado para o módulo principal.

---

## 5. Próximos Passos (Implementação)
1.  Criar `IHMCard.cls`.
2.  Criar rotina de geração de controles (`Factory`).
3.  Testar rolagem e clique.
