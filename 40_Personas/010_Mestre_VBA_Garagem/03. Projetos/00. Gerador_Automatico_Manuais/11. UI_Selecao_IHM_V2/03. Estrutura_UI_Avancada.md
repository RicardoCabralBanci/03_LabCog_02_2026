# Especificação de UI v2: O Cockpit de Engenharia

**Status**: Definido (Layout Horizontal Restaurado)  
**Conceito**: Interface Híbrida com Filtros Horizontais no Topo.
**Objetivo**: Permitir seleção dinâmica, visualização de estrutura e inserção de assets personalizados.

---

## 1. Grid System (Layout Geral)

A tela adota um layout de "Três Painéis" com uma Sidebar sólida à esquerda.

| Colunas | Zona | Função | Comportamento |
| :--- | :--- | :--- | :--- |
| **A** | **Zona A.1 (Sidebar)** | Menu de Filtros | Fundo Sólido (Cinza Escuro) |
| **B** | *Gutter* | Margem de Respiro | Vazio (Largura 2px) |
| **C:E** | **Zona A.2 (Galeria)** | Cards das IHMs | Fundo Branco |
| **F** | *Espaçador* | Separador Visual | Vazio (Largura 2px) |
| **G:L** | **Zona B (Detalhes)** | Tabela de Manuais | Crescimento Vertical |
| **M** | *Espaçador* | Separador | Vazio |
| **N:Q** | **Zona C (Input)** | Área de Screenshot | Fixa no Topo (Linhas 5-20) |

---

## 2. Detalhamento da Zona A (O Menu Dividido)

### A. Sidebar de Filtros (Coluna A)
Uma barra vertical de "Smart Tiles" para filtragem intuitiva, mantendo o texto sempre horizontal para leitura rápida.

**1. Design dos Filtros (Smart Tiles):**
Shapes retangulares com cantos levemente arredondados que alternam estados visuais:
*   **Estado ATIVO (On)**: Fundo com cor vibrante ou Cinza Iluminado (Realce), Texto em Negrito. Indica que este fabricante está selecionado para exibição.
*   **Estado INATIVO (Off)**: Fundo Cinza muito claro (Mudo), Borda fina e discreta, Texto em tom cinza médio.
*   *Vantagem*: Proporciona uma estética de "Dashboard Moderno" e facilita o clique em telas touch.

**2. Feature "Collapsible" (Afazer):**
*   **Gatilho**: Ícone "Hamburger" ou "Filtro" fixo na célula **B2**.
*   **Ação**: Comando VBA `Columns("A").Hidden = Not Columns("A").Hidden`.
*   **UX**: Ao ocultar a Coluna A, a galeria (B:C) ganha mais respiro lateral. Útil para quando o engenheiro já filtrou o que precisava e quer focar na escolha do modelo.
* 

### B. A Galeria de Cards (Colunas B:D)
Área de exibição dinâmica que apresenta os modelos de IHM filtrados.

**1. Anatomia do Card (Visual Components):**
Cada card é um grupo de shapes construído dinamicamente:
*   **Header (ID Visual)**: Cor da borda baseada no campo `Status`.
    *   *Ativo*: Azul KHS | *Legado*: Amarelo | *Crítico*: Vermelho.
*   **Corpo**: Nome do `Modelo` em destaque e `Fabricante` como subtítulo.
*   **Badges de Engenharia**: Dois pequenos selos no rodapé do card:
    *   `Badge_Engine`: Valor do campo `Engine` (ex: Zenon, WinCC).
    *   `Badge_Size`: Valor do campo `Tamanho` (ex: 15", 21").
*   **Thumbnail**: Espaço para a imagem `Path_Thumbnail`.

**2. Lógica de Renderização (`Sub Render_Gallery`):**
*   **Loop**: Varre `tbl_IHM_Definitions`.
*   **Filtro Ativo**: Se o `Fabricante` da linha não estiver "On" nos Smart Tiles da Sidebar, a linha é pulada.
*   **Identificação de Clique**: Cada card recebe o nome `CARD_ID_[ID]` (ex: `CARD_ID_1`). Ao clicar, a macro recupera o ID via `Split(Application.Caller, "_")(2)`.

**3. Comportamento de Seleção:**
*   Ao clicar, o card ganha um "Glow" (brilho externo) ou borda dupla.
*   Dispara instantaneamente a limpeza e repopulação da **Zona B (Detalhes)**.

---

## 3. Detalhamento da Zona B (O Compositor de Manuais)

Esta zona (Colunas **F:K**) atua como um painel de confirmação dupla: Visual (Esquerda) e Documental (Direita).

### B.1 Sub-Painel Visual (Colunas F:G)
*   **Objetivo**: Identidade Visual ("É desta máquina que estamos falando?").
*   **Componentes**:
    1.  **Thumbnail Ampliada**: O VBA carrega a imagem definida em `Path_Thumbnail` e a exibe ocupando a largura de F:G (aprox. linhas 5 a 15).
    2.  **Descrição Técnica**: Logo abaixo da imagem, injeta o texto do campo `Descricao_Visual` (fonte itálico, cinza escuro) para diferenciar versões sutis.
*   **Estática**: Estes elementos são fixos no topo, não rolam com a lista lateral.

### B.2 O Separador (Coluna H)
*   **Visual**: Coluna estreita (Width ~2).
*   **Estilo**: Preenchimento cinza muito claro ou uma borda direita pontilhada na coluna G, criando uma fronteira visual elegante entre o "Hardware" e o "Software".

### B.3 Lista de Referências (Colunas I:K)
Lista imutável dos documentos que compõem o manual desta IHM. O engenheiro não seleciona (tudo é obrigatório), apenas confere.

*   **Fonte de Dados**: Tabela `tbl_Module_Mapping` filtrada pelo ID da IHM.
*   **Estrutura da Tabela**:
    *   **Cabeçalho (Linha 4)**: "Módulo" | "Template Base" | "Preview".
    *   **Linhas (5+)**:
        *   **Col I (Módulo)**: Nome do Capítulo (ex: "01. Interface"). Fonte Segoe UI Semibold.
        *   **Col J (Arquivo)**: Nome do arquivo (ex: `CL30_Interface.docx`). Fonte Consolas (Monospace) pequena, cor cinza.
        *   **Col K (Ação)**: Ícone estilizado do Word (Shape ou Imagem).
*   **Interatividade (Preview)**:
    *   Evento: `SelectionChange` na coluna K.
    *   Ação: Valida se o arquivo existe e o abre em modo `ReadOnly`. Se não existir, exibe MsgBox crítico.

---

## 4. Detalhamento da Zona C (Landing Zone de Input)

Localizada nas colunas **M:P**, esta área é o ponto de interação do usuário. Seguindo a regra de "Pixel Perfect" (ver `03.2. Grid_Logica`), ela respeita a altura padrão das linhas (15pt).

### C.1 A Landing Zone (Container)
*   **Posição**: Range `M5:P19` (Total de 15 linhas x 15pt = 225pt de altura).
*   **Visual**:
    *   **Shape de Fundo**: Retângulo arredondado transparente.
    *   **Borda**: Tracejada (DashStyle: Dash), Cor Cinza Médio, Espessura 2pt.
    *   **Texto de Placeholder**: "Cole aqui o Print da IHM\n(Ctrl+V) ou clique no botão abaixo".

### C.2 Ferramentas de Importação
Localizadas logo abaixo da Landing Zone (Linha 21).

*   **Botão [Colar do Clipboard]**:
    *   **Macro `UI_Paste_Smart`**:
        1.  Detecta se há bitmap no Clipboard.
        2.  Cola como Shape.
        3.  **Fit Logic**: Redimensiona a imagem para caber no range `M5:P19` mantendo `LockAspectRatio = msoTrue`.
        4.  Centraliza (CenterHorizontally, CenterVertically) dentro do range.
        5.  **Tagging**: Nomeia o shape final como `IMG_USER_COVER`.
        6.  **Feedback**: Muda a borda da Landing Zone para **Verde Sólido** e exibe um "Check" ✔️ no canto.

### C.3 O Botão "Ignite" (Geração)
Localizado na Linha 24, ocupando a largura M:P.

*   **Design**: Botão grande, cor de destaque (Azul KHS ou Verde Ação), Texto "GERAR MANUAL".
*   **Macro `Main_Ignite_Sequence`**:
    1.  **Validação**: Verifica se `IMG_USER_COVER` existe. Se não, alerta (Soft Block) ou pergunta se deseja usar capa padrão.
    2.  **Exportação**: Salva `IMG_USER_COVER` como `temp_capa.png`.
    3.  **Coleta**: Varre a Zona B e monta a lista de documentos.
    4.  **Disparo**: Chama o motor de geração (C# ou VBA).

---

## 5. Resumo da Engenharia de Dados (Backend)

Todas as zonas são alimentadas por estruturas VBA robustas:

```vba
' Estrutura do Card em Memória
Public Type UI_Card_Data
    ID As Long
    Modelo As String
    Fabricante As String
    Status As String        ' Define a cor da borda
    Path_Thumb As String    ' Para Zona B (Visual)
End Type

' Controle de Estado dos Filtros
Public Type FilterState
    ShowKHS As Boolean
    ShowSiemens As Boolean
    ShowRockwell As Boolean
End Type
```
*A lógica de renderização deve sempre limpar os Ranges (ClearContents / Delete Shapes) antes de redesenhar para evitar "fantasmas" de seleções anteriores.*