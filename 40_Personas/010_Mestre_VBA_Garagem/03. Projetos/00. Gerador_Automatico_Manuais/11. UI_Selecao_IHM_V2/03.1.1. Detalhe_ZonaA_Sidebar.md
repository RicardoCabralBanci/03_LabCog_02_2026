# Especificação Técnica: Zona A.1 (Sidebar de Navegação)

**Referência**: Coluna A do Grid System.
**Objetivo**: Controle de filtragem rápido e intuitivo. É o "Menu Principal" da aplicação.

---

## 1. Design Visual (Smart Tiles)

A Sidebar não é apenas uma lista de botões comuns. São "Smart Tiles" (Azulejos Inteligentes) que servem como indicadores de estado.

**Dimensões:**
*   **Largura**: Ocupa 90% da largura da Coluna A (~120px).
*   **Altura**: 45px (Altura confortável para toque/mouse).
*   **Margem Vertical**: 10px entre cada botão.

**Estados Visuais:**

| Estado | Cor de Fundo | Cor do Texto | Borda | Efeito |
| :--- | :--- | :--- | :--- | :--- |
| **OFF (Inativo)** | `RGB(240, 240, 240)` (Cinza Muito Claro) | `RGB(100, 100, 100)` (Cinza Médio) | Nenhuma | Opacidade 100% |
| **ON (Ativo)** | **Cor da Marca** (Ver Tabela de Cores) | `RGB(255, 255, 255)` (Branco Puro) | Nenhuma | Sombra Suave |

---

## 2. Paleta de Cores (Identidade das Marcas)

As cores dos botões **ATIVOS** devem coincidir com os Badges da Galeria para criar coerência visual.

*   **Botão CLEARLINE**: `RGB(110, 130, 150)` (Cinza Azulado KHS)
*   **Botão SIEMENS**: `RGB(0, 101, 189)` (Azul Siemens)
*   **Botão ROCKWELL**: `RGB(230, 70, 0)` (Laranja Rockwell)

---

## 3. Comportamento Lógico (Toggle)

Cada botão funciona como um interruptor (Switch).

1.  **Evento de Clique**:
    *   O usuário clica no botão "SIEMENS".
    *   O VBA verifica o estado atual (armazenado em variável global ou propriedade do shape).
    *   Inverte o estado (Se estava ON, vira OFF; se estava OFF, vira ON).

2.  **Ação Imediata**:
    *   Atualiza a cor do botão (Visual Feedback).
    *   Chama a função `Refresh_Gallery()` na Zona A.2.
    *   *Nota*: A Galeria é redesenhada instantaneamente mostrando apenas os itens cujos filtros estão ON.

3.  **Regra de Exclusão (Opcional)**:
    *   Podemos permitir seleção múltipla (ver KHS e Siemens ao mesmo tempo) ou exclusiva (Radio Button).
    *   *Decisão Atual*: **Seleção Múltipla** (Checkbox logic), pois permite comparar opções.

---

## 4. Implementação Técnica (VBA)

Não usaremos controles ActiveX. Usaremos Shapes nativos (`msoShapeRoundedRectangle`) por serem mais leves, bonitos e estáveis.

```vba
Sub Toggle_Sidebar_Filter()
    Dim btnID As String
    btnID = Application.Caller ' Identifica qual botão foi clicado (ex: "btn_filter_siemens")
    
    ' Lógica simplificada de Toggle Visual
    Dim shp As Shape
    Set shp = ActiveSheet.Shapes(btnID)
    
    If shp.Fill.ForeColor.RGB = COR_CINZA_INATIVO Then
        ' Ligar
        shp.Fill.ForeColor.RGB = GetBrandColor(btnID)
        shp.TextFrame.Characters.Font.Color = vbWhite
    Else
        ' Desligar
        shp.Fill.ForeColor.RGB = COR_CINZA_INATIVO
        shp.TextFrame.Characters.Font.Color = COR_CINZA_ESCURO
    End If
    
    ' Gatilho
    Call Render_Gallery
End Sub
```
