# Plano de Refatora√ß√£o Modular (v4.0) - A Separa√ß√£o dos Poderes

**Objetivo**: Desacoplar a interface (Zona A) da l√≥gica de detalhes (Zona B) e criar um n√∫cleo comum de defini√ß√µes.

---

## 1. Vis√£o Geral da Arquitetura

| M√≥dulo | Nome do Arquivo | Responsabilidade | Status |
| :--- | :--- | :--- | :--- |
| **N√∫cleo** | `mod_Shared_Definitions` | Armazena Cores (Consts) e Tipos de Dados (Types). | ‚ú® Novo |
| **Front-End** | `mod_UI_ZoneA` | Desenha a Galeria, Filtros e gerencia o Clique. | üîÑ Refatorado |
| **Detalhes** | `mod_UI_ZoneB` | Desenha o Painel de Hardware e Lista de Docs. | ‚ú® Novo |

---

## 2. Altera√ß√µes Realizadas

### A. Cria√ß√£o do `mod_Shared_Definitions`
*   **Movido**: Todas as constantes de cores (`CLR_...`) foram movidas para c√° como `Public`.
*   **Movido**: A estrutura `Type T_IHM_Card` foi movida para c√°.
*   **Adicionado**: Nova estrutura `Type T_Doc_Item` para gerenciar a lista de manuais da Zona B.

### B. Refatora√ß√£o da `mod_UI_ZoneA` (Antigo Core)
*   **Limpeza**: Removidas declara√ß√µes locais de `Type` e `Const` que agora est√£o no Shared.
*   **Integra√ß√£o**: O evento `Card_Click_Handler` foi reescrito. Agora ele:
    1.  Identifica o ID do card clicado.
    2.  Localiza os dados completos desse ID no Cat√°logo.
    3.  Chama `mod_UI_ZoneB.Render_ZoneB(selectedData)`.

### C. Implementa√ß√£o da `mod_UI_ZoneB`
*   **Novo M√©todo**: `Render_ZoneB(data As T_IHM_Card)` √© a porta de entrada.
*   **L√≥gica Visual**: Implementadas rotinas para desenhar thumbnails grandes e listas de documentos.
*   **L√≥gica de Arquivo**: Adicionada verifica√ß√£o `Dir()` para pintar √≠cones de Azul (Existe) ou Vermelho (Ausente).
*   **Mocking**: Inclu√≠da fun√ß√£o `Mock_Fetch_Docs` para simular o banco de dados enquanto n√£o temos o SQL real.

---

## 3. Como Importar no VBA
1.  Apague o m√≥dulo antigo `mod_UI_Core`.
2.  Importe os 3 novos arquivos (`.bas` gerados a partir dos `.md`).
3.  Compile o projeto.

---
**Nota do Mestre**: Esta estrutura permite que voc√™ edite o layout da Zona B sem risco algum de quebrar a Galeria da Zona A. √â a defini√ß√£o de "Separa√ß√£o de Preocupa√ß√µes" (SoC).
