Attribute VB_Name = "mod_Navegacao_V3"
Option Explicit

' ==========================================================================================
' MÓDULO: mod_Navegacao_V3
' DESCRIÇÃO: Extensão das rotinas de navegação para as máquinas PLT e PCK.
' PADRÃO: Mantendo o formato original de uma linha por Sub.
' ==========================================================================================

' --- NAVEGAÇÃO PALETIZADOR (PLT) ---
Sub PLTPG1(Optional byDummy As Byte): Planilha43.Activate: End Sub
Sub PLTPG2(Optional byDummy As Byte): Planilha46.Activate: End Sub
Sub PLTPG3(Optional byDummy As Byte): Planilha47.Activate: End Sub

' --- NAVEGAÇÃO ENCAIXOTADORA (PCK) ---
Sub PCKPG1(Optional byDummy As Byte): Planilha48.Activate: End Sub
Sub PCKPG2(Optional byDummy As Byte): Planilha51.Activate: End Sub
Sub PCKPG3(Optional byDummy As Byte): Planilha52.Activate: End Sub

' ==========================================================================================
' SCRIPTS DE REPARO AUTOMÁTICO (Remapeamento de Botões Legados)
' ==========================================================================================

Sub RepararBotoes_PLT()
    Dim shp As Shape, iFix As Integer
    iFix = 0
    
    For Each shp In ActiveSheet.Shapes
        If shp.OnAction Like "*CCMXPG2*" Then
            shp.OnAction = "PLTPG2"
            iFix = iFix + 1
        End If
        
        If shp.OnAction Like "*CCMXPG3*" Then
            shp.OnAction = "PLTPG3"
            iFix = iFix + 1
        End If
        
        If (shp.Name = "Round Same Side Corner Rectangle 6" Or shp.Name = "Round Same Side Corner Rectangle 7") And shp.OnAction = "" Then
            shp.OnAction = "PLTPG1"
            iFix = iFix + 1
        End If
    Next shp
    
    MsgBox "Paletizador: " & iFix & " botões remapeados.", vbInformation
End Sub

Sub RepararBotoes_PCK()
    Dim shp As Shape, iFix As Integer
    iFix = 0
    
    For Each shp In ActiveSheet.Shapes
        If shp.OnAction Like "*CCMXPG2*" Then
            shp.OnAction = "PCKPG2"
            iFix = iFix + 1
        End If
        
        If shp.OnAction Like "*CCMXPG3*" Then
            shp.OnAction = "PCKPG3"
            iFix = iFix + 1
        End If
        
        If (shp.Name = "Round Same Side Corner Rectangle 6" Or shp.Name = "Round Same Side Corner Rectangle 7") And shp.OnAction = "" Then
            shp.OnAction = "PCKPG1"
            iFix = iFix + 1
        End If
    Next shp
    
    MsgBox "Encaixotadora: " & iFix & " botões remapeados.", vbInformation
End Sub

