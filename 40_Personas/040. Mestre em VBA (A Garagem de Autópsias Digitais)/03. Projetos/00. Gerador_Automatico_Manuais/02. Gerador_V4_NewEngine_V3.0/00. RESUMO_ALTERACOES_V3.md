# Resumo de Alterações - Versão 3.0 (Expansão Logística)

**Data**: 14/01/2026
**Responsável**: [[004. Mestre em VBA]]
**Contexto**: Inclusão de máquinas de fim de linha (Paletizador e Encaixotadora).

---

## 1. Ribbon (Interface)
*   **Arquivo**: `01. Ribbon_V3.xml.md`
*   **Mudança**: Adição de duas novas abas:
    *   **PLT (ID 8)**: Paletizador.
    *   **PCK (ID 9)**: Encaixotadora.
*   **Ícones**: Reutilização de ícones existentes (`storage-tank`) como placeholder.
*   **Funcionalidade**: Botões de navegação, preenchimento e geração replicados do padrão CCMX.

## 2. VBA (Callbacks)
*   **Arquivo**: `02. mod_Ribbon_Callbacks_V3.bas.md`
*   **Ruptura com o Legado**:
    *   As funções `Ger8` (PLT) e `Ger9` (PCK) **não chamam** módulos antigos (como `btr.Manual`).
    *   **Nova Rota**: Chamada direta para `mod_NewEngine_V5.Gerar_PLT` e `mod_NewEngine_V5.Gerar_PCK`.
    *   **NOTA TÉCNICA CRÍTICA**: Atualmente, `Gerar_PLT` e `Gerar_PCK` redirecionam internamente para `ExportarParaNovoGerador("CCMX")`.
        *   Isso significa que o C# receberá o tipo "CCMX" e usará os arquivos mapeados para a CCMX na Base de Dados.
        *   Esta é uma medida provisória (Mock) até que as linhas exclusivas para PLT/PCK sejam criadas na Base de Dados e a lógica de filtro no C# seja atualizada.
    *   Isso confirma a migração total da lógica de geração para a Engine C# / Python nestes novos módulos.
*   **Validação**:
    *   Substituição da verificação linha-a-linha (CountBlank) por uma confirmação simples do usuário (`MsgBox vbYesNo`).
    *   *Nota*: Assume-se que o operador sabe o que está fazendo, reduzindo a "babá eletrônica" do código antigo.

## 3. Estrutura de Planilhas (Previsão)
O código VBA faz referência a planilhas que precisam existir:
*   **PLT**: Planilhas 43, 46, 47.
*   **PCK**: Planilhas 48, 51, 52.

## 4. Navegação e Correção de Interface
*   **Módulo**: `04. mod_Navegacao_V3.bas.md`
*   **Descoberta**: Os botões azuis de navegação interna (Mecânica, Elétrica, IHM) chamam macros `CCMXPG1`, `CCMXPG2` e `CCMXPG3`.
*   **Correção**: 
    *   Criadas Subs compactas (ex: `Sub PLTPG1(Optional byDummy As Byte): Planilha43.Activate: End Sub`).
    *   Desenvolvido script `RepararBotoes_PLT` e `PCK` para remapear as macros de `CCMX...` para `PLT...` ou `PCK...` automaticamente via Loop `For Each shp In ActiveSheet.Shapes`.


## 5. Correções de UI (UserForms)
*   **Formulário**: `05. Form_Info.md`
*   **Problema**: Corte lateral e texto não cabendo devido à escala de DPI do Windows (Bug clássico do VBA).
*   **Solução**: 
    *   Forçado `Me.Width` e `Me.Zoom = 100` no `Initialize`.
    *   Implementado loop para ativar `AutoSize` em todos os Labels, garantindo legibilidade independente da escala do monitor.

---
**Próximos Passos**:
1.  Individualização da Base de Dados (PLT/PCK).
2.  Implementar as funções `Gerar_PLT` e `Gerar_PCK` no backend C#.

