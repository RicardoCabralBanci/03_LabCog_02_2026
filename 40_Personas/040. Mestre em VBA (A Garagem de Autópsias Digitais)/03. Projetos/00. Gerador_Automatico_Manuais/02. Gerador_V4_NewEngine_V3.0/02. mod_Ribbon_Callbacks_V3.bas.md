Segue Attribute VB_Name = "mod_Ribbon_Callbacks"
Option Explicit

' --- FUNÇÕES GERAIS E LEGADO ---

Sub limpeza(ByRef i As Integer, Optional byDummy As Byte)
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets(i)
        Select Case i
            Case 4, 7 To 10, 15 To 18, 29
                .Unprotect vbNullString: .Range("B4:H100").ClearContents: .Protect vbNullString
            Case 5, 6, 11, 13, 14, 19, 24, 28, 30, 33, 37, 41
                .Unprotect vbNullString: .Range("D4:D100").ClearContents: .Protect vbNullString
            Case 21, 22, 26, 31, 35, 38, 39
                .Unprotect vbNullString: .Range("E4:E100").ClearContents: .Protect vbNullString
            Case 23
                .Unprotect vbNullString: .Range("C4:C6").ClearContents: .Protect vbNullString
            Case 25
                .Unprotect vbNullString: .Range("D4:E100").ClearContents: .Protect vbNullString
            Case 27
                .Unprotect vbNullString: .Range("C3").ClearContents: .Range("C7:C9").ClearContents
                .Range("C13:C15").ClearContents: .Range("C19:C22").ClearContents: .Range("H3:H22").ClearContents: .Protect vbNullString
            Case 32
                .Unprotect vbNullString: .Range("C5:C7").ClearContents: .Range("C11:C12").ClearContents
                .Range("C16:C20").ClearContents: .Range("H5:H20").ClearContents: .Protect vbNullString
            Case 36
                .Unprotect vbNullString: .Range("C5:C7").ClearContents: .Range("C11:C13").ClearContents
                .Range("G11").ClearContents: .Range("H5:H7").ClearContents: .Protect vbNullString
            Case 40
                .Unprotect vbNullString: .Range("C5:C7").ClearContents: .Range("C11:C13").ClearContents
                .Range("G5:G6").ClearContents: .Range("H10:H13").ClearContents: .Protect vbNullString
        End Select
    End With
    Planilha3.Unprotect
    Application.EnableEvents = True: Application.ScreenUpdating = True
End Sub

Sub instruc(Optional byDummy As Byte): Instruções.Show: End Sub

Sub z(control As IRibbonControl)
    On Error GoTo exitsub
    Exit Sub
    ' Código legacy oculto omitido para brevidade
exitsub:
End Sub

'Callback for Salvar onAction
Sub GoSave(control As IRibbonControl)
    On Error GoTo message
    ThisWorkbook.Save
    Exit Sub
message:
    MsgBox "Ainda não foi salvo pela primeira vez, use a aba fixa 'Arquivo'", vbCritical, "Arquivo não existente ainda"
End Sub

'Callback for Inf0 onAction
Sub Inform(control As IRibbonControl): Info.Show: End Sub

'Callback for Im0 onAction
Sub SImagem(control As IRibbonControl)
    Dim an As Integer
    With Planilha2
        an = MsgBox("Deseja extrair as imagens de exemplo para conferência?" & vbNewLine & vbNewLine & _
        "Está opção fará a execução ser consideravelmente mais lenta!", vbQuestion + vbYesNoCancel, "Extração de imagens")
        If an = vbYes Then
            .Range("G3").Value = "Exemplos"
        ElseIf an = vbCancel Then
            Exit Sub
        Else: .Range("G3").Value = vbNullString: End If
        .Range("G1").Value = "Imagem"
    End With
    Call Imagem.PopulateXL
End Sub

'Callback for Tab0 onAction
Sub STabela(control As IRibbonControl)
    Dim an As Integer
    With Planilha2
        an = MsgBox("Deseja extrair as tabelas de exemplo para conferência? As mesmas podem ser encontradas na pasta de template." & vbNewLine _
        & vbNewLine & "Está opção fará a execução ser consideravelmente mais lenta!", vbQuestion + vbYesNoCancel, "Extração de imagens")
        If an = vbYes Then
            .Range("G3").Value = "Exemplos"
        ElseIf an = vbCancel Then
            Exit Sub
        Else: .Range("G3").Value = vbNullString: End If
        .Range("G1").Value = "Tabela"
    End With
    Call Tabela.PopulateXL
End Sub

'Callback for Proteger onAction
Sub GoProtect(control As IRibbonControl)
    Dim X As Boolean
    With ThisWorkbook.ActiveSheet
        X = .ProtectContents
        If X = False Then
            .Protect vbNullString
        Else: .Unprotect vbNullString: End If
    End With
End Sub

'Callback for Códigos onAction
Sub GoCode(control As IRibbonControl): Application.VBE.MainWindow.Visible = True: End Sub

'Callback for Restart onAction
Sub Restart(control As IRibbonControl)
    Application.EnableEvents = False
    Dim i As Integer, an As Integer
    an = MsgBox("Todas páginas serão reiniciadas, deseja continuar?", vbExclamation + vbYesNo, "Atenção")
    If an = vbYes Then
        For i = 4 To ThisWorkbook.Sheets.Count
            Call limpeza(i)
        Next
    End If
    Application.EnableEvents = True
End Sub

'Callback for Informações onAction
Sub GoInfo(control As IRibbonControl)
    Dim an As Integer
    an = MsgBox("Este arquivo se destina a geração de manuais de operação dos modelos apresentados nas abas." & _
    vbNewLine & vbNewLine & "Deseja ir para página de instruções para mais informações?", vbInformation + vbYesNo, "Informação pertinente")
    If an = vbYes Then
        With Planilha1
            .Visible = xlSheetVisible
            .Activate
        End With
    End If
End Sub

'Callback for Ajuda onAction
Sub GoAjuda(control As IRibbonControl)
    MsgBox "Caso ocorra algum erro ou tenha dúvidas, favor entrar em contato com o responsável pela área de documentação!" & _
    vbNewLine & vbNewLine & "Antes de entrar em contato, favor verificar a página de instruções apertando o botão de 'Informações'." _
    , vbExclamation, "Ajuda"
End Sub

' --- CALLBACKS ESPECÍFICOS POR MÁQUINA (LEGADO) ---
' [Omissão de BTR, GTR, DVD, PET, CIP, CMX, CCMX para focar na V3 - mantidos no original]
' ... (Callbacks de 1 a 7 permanecem idênticos ao V2)

' --- PALETIZADOR (PLT) - NOVO NA V3 -------------------------------------------------------------------

'Callback for MecPLT onAction
Sub Mec8(control As IRibbonControl)
    On Error GoTo ErroNavegacao
    Planilha43.Activate ' PLT Estrutura
    Exit Sub
ErroNavegacao:
    MsgBox "Erro ao acessar a aba 'Planilha43'. Verifique se ela foi clonada corretamente.", vbCritical
End Sub

'Callback for ElPLT onAction
Sub El8(control As IRibbonControl)
    On Error Resume Next
    Planilha46.Activate ' PLT Elétrica
End Sub

'Callback for IHMPLT onAction
Sub IHM8(control As IRibbonControl)
    On Error Resume Next
    Planilha47.Activate ' PLT IHM
End Sub

'Callback for Ex8 onAction
Sub Ex8(control As IRibbonControl)
    Planilha2.Cells(20, 2).Value = Planilha2.Cells(20, 1).Value
    Planilha2.Cells(20, 1).Value = "PLT"
    Exceções.Show
End Sub

'Callback for GerPLT onAction
Sub Ger8(control As IRibbonControl)
    ' Chama a Nova Engine V5 DIRETAMENTE (Sem passar pelo legado)
    On Error GoTo ErroGeral
    
    If MsgBox("Deseja gerar o manual do Paletizador agora?", vbQuestion + vbYesNo, "Confirmar Geração") = vbYes Then
        Call mod_NewEngine_V5.Gerar_PLT
    End If
    Exit Sub
    
ErroGeral:
    MsgBox "Erro ao tentar iniciar a geração: " & Err.Description, vbCritical
End Sub

'Callback for GIHMPLT onAction (Atualização de IHM - Placeholder)
Sub GIMH8(control As IRibbonControl)
    MsgBox "Funcionalidade de atualização automática de IHM ainda em desenvolvimento para PLT.", vbInformation
End Sub


' --- ENCAIXOTADORA (PCK) - NOVO NA V3 -----------------------------------------------------------------

'Callback for MecPCK onAction
Sub Mec9(control As IRibbonControl)
    On Error GoTo ErroNavegacao
    Planilha48.Activate ' PCK Estrutura
    Exit Sub
ErroNavegacao:
    MsgBox "Erro ao acessar a aba 'Planilha48'. Verifique se ela foi clonada corretamente.", vbCritical
End Sub

'Callback for ElPCK onAction
Sub El9(control As IRibbonControl)
    On Error Resume Next
    Planilha51.Activate ' PCK Elétrica
End Sub

'Callback for IHMPCK onAction
Sub IHM9(control As IRibbonControl)
    On Error Resume Next
    Planilha52.Activate ' PCK IHM
End Sub

Sub Ex9(control As IRibbonControl)
    Planilha2.Cells(20, 2).Value = Planilha2.Cells(20, 1).Value
    Planilha2.Cells(20, 1).Value = "PCK"
    Exceções.Show
End Sub

'Callback for GerPCK onAction
Sub Ger9(control As IRibbonControl)
    On Error GoTo ErroGeral
    If MsgBox("Deseja gerar o manual da Encaixotadora agora?", vbQuestion + vbYesNo, "Confirmar Geração") = vbYes Then
        Call mod_NewEngine_V5.Gerar_PCK
    End If
    Exit Sub
ErroGeral:
    MsgBox "Erro ao tentar iniciar a geração: " & Err.Description, vbCritical
End Sub

'Callback for GIHMPCK onAction
Sub GIMH9(control As IRibbonControl)
    MsgBox "Funcionalidade de atualização automática de IHM ainda em desenvolvimento para PCK.", vbInformation
End Sub
