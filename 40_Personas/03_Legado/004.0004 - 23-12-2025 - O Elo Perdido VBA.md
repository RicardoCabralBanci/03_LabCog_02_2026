# Histórico de Sessão: O Elo Perdido VBA
**Persona**: [[004. Mestre em VBA]]
**Data**: 23/12/2025
**Iteração**: 004

---

## 1. O Novo Contrato (VBA <-> C#)
Com a demissão do orquestrador Python, o VBA precisava de uma reeducação. Ele não podia mais esperar que alguém limpasse sua bagunça.
*   **Ação**: Criamos fisicamente o arquivo `mod_NewEngine.bas`.

## 2. Anatomia do `mod_NewEngine.bas`
Este módulo é a única peça de código VBA que sobreviverá no longo prazo. Suas características vitais são:
*   **Geração de Manifesto UTF-8**: Abandonamos o método nativo de I/O do VBA (que é ANSI/ASCII e odeia acentos) em favor do `ADODB.Stream`. Isso garante que caminhos como `...\Atenção\...` não quebrem o motor C#.
*   **Caminhos Relativos**: O script assume que a pasta `NewGerador` é irmã do arquivo Excel. Isso elimina o hardcoding de drives de rede (`V:`).
*   **Disparo Direto**: Utilizamos o comando `Shell` para invocar `NewGerador.exe` passando o manifesto como argumento. Simples, brutal e eficaz.

## 3. Estrutura de Dados (Aba Mestra)
Definimos constantes configuráveis para a leitura:
*   `TARGET_SHEET_NAME`: "Dados Salvos" (com fallback para "Base de Dados").
*   `COL_PATH`: Coluna "G" (Caminhos).
*   `COL_ACTIVE`: Coluna "B" (Flags "Yes/No").

## 4. Próximos Passos
*   **Importação Manual**: O usuário deve importar este `.bas` para dentro do `Gerador_V4.xlsm` (via `Alt+F11` > `Import File`).
*   **Teste de Fogo**: Rodar a macro `ExportarParaNovoGerador` e verificar se o `input_manifest.csv` é criado corretamente na raiz e se o console do C# abre.

---
*"O VBA agora fala a língua do manifesto. Sem intermediários, sem desculpas."* - Mestre em VBA
