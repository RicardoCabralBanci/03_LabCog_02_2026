# 0200. Mapeamento de Dados: Gerador_V4.xlsm

**Objeto de Análise**: `Gerador_V4  - Atualizado.xlsm`
**Data da Extração**: 18/12/2025
**Ferramenta**: `analyze_excel.py` (pandas/openpyxl)

---

## 1. Visão Geral da Estrutura
O arquivo Excel atua como um Banco de Dados Relacional simplificado e Painel de Controle. Ele não contém apenas configurações, mas a lógica de negócio de *quais* partes do manual devem ser montadas.

### Abas Principais
| Nome da Aba | Função no Sistema Legado | Destino na Migração (Python) |
| :--- | :--- | :--- |
| **Dados Salvos** | **Maestro**. Define Projeto, Revisão e a lista sequencial de arquivos `.docx` a serem mesclados. | `config.json` ou Tabela Mestra em DB. Fonte primária do Loop de Montagem. |
| **Componentes integrados** | Lista de peças de terceiros. Copiada via Clipboard. | DataFrame do Pandas -> Tabela XML nativa do Word. |
| **Instruções de Uso** | Avisos de segurança do processo manual. | Obsoleto (Processo será automático). |

---

## 2. Abas de Configuração de Máquina (Features)
O sistema suporta múltiplas tecnologias (`BTR`, `GTR`, `DVD`, `PET`, `CIP`, `CMX`, `CCMX`). Cada uma possui um conjunto de abas dedicadas que funcionam como "Feature Flags".

**Padrão de Colunas**:
*   **Dispositivo/Módulo**: Nome do componente (ex: "Interruptor Principal").
*   **Preview**: (Provavelmente imagem ou link, ignorado na extração de texto).
*   **Aplicável (X)**: O booleano crítico. Se marcado com "X", o componente é incluído.

### Exemplo de Estrutura (DVD)
*   `DVD Máquina`: Configurações estruturais (Sala higiênica, Enclausuramento).
*   `DVD Manifold`: Válvulas e redutores.
*   `DVD Dados do sistema`: Tabela Chave-Valor (Especificação, Valor, Unidade). **Crítico**: Estes dados preenchem tabelas técnicas no Word.
*   `DVD Botoeiras`: Quantitativo de botões (P100, P300).

---

## 3. Lógica de Negócio Identificada
1.  **Loop de Montagem**: O script percorre a aba `Dados Salvos`. Se a coluna (provavelmente "Yes/No") estiver ativa, ele busca o arquivo `.docx` referenciado no caminho de rede.
2.  **Injeção de Tabelas**: O script busca tabelas no Word com "Títulos" específicos (ex: "Dados Técnicos") e substitui seu conteúdo pelo que encontra nas abas de dados técnicos do Excel (`DVD Dados do sistema`, etc.).

---

## 4. Estratégia de Leitura (Python)
Para a ferramenta nova, não vamos ler célula por célula.
1.  Carregar `Dados Salvos` em um DataFrame. Filtrar onde `Ativo == "Yes"`.
2.  Carregar abas de dados técnicos (ex: `DVD Dados do sistema`) em DataFrames/Dicionários.
3.  Passar esse contexto para o renderizador de templates (`docxtpl`), substituindo variáveis como `{{velocidade_nominal}}` pelos valores extraídos.

---
*Documento gerado automaticamente a partir de análise forense do arquivo binário.*
